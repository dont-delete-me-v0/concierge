# Concierge

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è–º–∏ —Å Telegram –±–æ—Ç–æ–º, –≤–µ–±-–∫—Ä–∞—É–ª–µ—Ä–æ–º –∏ API.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker)

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repo-url> concierge
cd concierge

# –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª
cp env.example .env
nano .env  # –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

### 2. –ó–∞–ø—É—Å–∫

```bash
# –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
make docker-build
make docker-up

# –ò–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
./deploy.sh
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
make docker-ps

# –õ–æ–≥–∏
make docker-logs

# Health check
curl http://localhost:3000/health
```

## üì¶ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–µ—Ä–≤–∏—Å—ã

- **API** (NestJS) - REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è–º–∏ (–ø–æ—Ä—Ç 3000)
- **Bot** (NestJS + Telegraf) - Telegram –±–æ—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ—Ä—Ç 3001)
- **Web Crawler** (Node.js + Cron) - –ü–∞—Ä—Å–µ—Ä —Å–∞–π—Ç–æ–≤ —Å —Å–æ–±—ã—Ç–∏—è–º–∏ (–∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–µ 3 —á–∞—Å–∞)
- **PostgreSQL** - –û—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–æ—Ä—Ç 5432)
- **Redis** - –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Å—Å–∏–π –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫—Ä–∞—É–ª–µ—Ä–∞ (–ø–æ—Ä—Ç 6379)
- **RabbitMQ** - –û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π (–ø–æ—Ä—Ç—ã 5672, 15672)
- **PgAdmin** - –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ë–î (–ø–æ—Ä—Ç 5050)
- **DB Backup** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –ë–î

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
concierge/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ api/              # NestJS API
‚îÇ   ‚îú‚îÄ‚îÄ bot/              # Telegram –±–æ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ web-crawler/      # –í–µ–±-–∫—Ä–∞—É–ª–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ instagram-crawler/
‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îú‚îÄ‚îÄ database/         # SQL –º–∏–≥—Ä–∞—Ü–∏–∏, –±—ç–∫–∞–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ eslint-config/    # –û–±—â–∞—è ESLint –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ prettier-config/  # –û–±—â–∞—è Prettier –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ docker-compose.yml    # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ deploy.sh            # –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
‚îî‚îÄ‚îÄ Makefile             # –£–¥–æ–±–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```

## üîß –ö–æ–º–∞–Ω–¥—ã

### Docker

| –ö–æ–º–∞–Ω–¥–∞               | –û–ø–∏—Å–∞–Ω–∏–µ               |
| --------------------- | ---------------------- |
| `make docker-build`   | –°–æ–±—Ä–∞—Ç—å Docker –æ–±—Ä–∞–∑—ã  |
| `make docker-up`      | –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã  |
| `make docker-down`    | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã |
| `make docker-restart` | –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã  |
| `make docker-logs`    | –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏        |
| `make docker-ps`      | –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤     |

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

| –ö–æ–º–∞–Ω–¥–∞                 | –û–ø–∏—Å–∞–Ω–∏–µ                    |
| ----------------------- | --------------------------- |
| `make backup`           | –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –ë–î            |
| `make backup-manual`    | –°–æ–∑–¥–∞—Ç—å —Ä—É—á–Ω–æ–π –±—ç–∫–∞–ø        |
| `make list-backups`     | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±—ç–∫–∞–ø–æ–≤         |
| `make restore FILE=...` | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞      |
| `make db-backup-logs`   | –õ–æ–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –±—ç–∫–∞–ø–æ–≤ |

### Web Crawler

| –ö–æ–º–∞–Ω–¥–∞               | –û–ø–∏—Å–∞–Ω–∏–µ                   |
| --------------------- | -------------------------- |
| `make crawler-logs`   | –õ–æ–≥–∏ –∫—Ä–∞—É–ª–µ—Ä–∞              |
| `make crawler-health` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –∫—Ä–∞—É–ª–µ—Ä–∞ |

### –î–µ–ø–ª–æ–π

```bash
# –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π —Å –±—ç–∫–∞–ø–æ–º
./deploy.sh

# –î–µ–ø–ª–æ–π –±–µ–∑ –±—ç–∫–∞–ø–∞
./deploy.sh --no-backup

# –¢–æ–ª—å–∫–æ —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤
./deploy.sh --build-only
```

## üîë –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Database
POSTGRES_USER=concierge_user
POSTGRES_PASSWORD=<strong_password>
POSTGRES_DB=concierge

# Telegram
TELEGRAM_BOT_TOKEN=<your_bot_token>
TELEGRAM_TRACKER_TOKEN=<tracker_bot_token>
TELEGRAM_CHAT_ID=<your_chat_id>
```

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–º. –≤ [`env.example`](env.example)

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –î–µ–ø–ª–æ–π –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è

- [QUICK_DEPLOY.md](QUICK_DEPLOY.md) - üöÄ –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π –∑–∞ 15 –º–∏–Ω—É—Ç
- [DEPLOYMENT.md](DEPLOYMENT.md) - üìñ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é
- [DOCKER_SETUP.md](DOCKER_SETUP.md) - üê≥ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

- [DEVELOPMENT.md](DEVELOPMENT.md) - üíª –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

- [packages/database/BACKUP_GUIDE.md](packages/database/BACKUP_GUIDE.md) - üíæ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±—ç–∫–∞–ø–∞–º
- [packages/database/QUICK_START.md](packages/database/QUICK_START.md) - ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –±—ç–∫–∞–ø–æ–≤

## üåê API Endpoints

### Health Check

```bash
GET /health
```

### –°–æ–±—ã—Ç–∏—è

```bash
GET /events                    # –í—Å–µ —Å–æ–±—ã—Ç–∏—è
GET /events/:id               # –û–¥–Ω–æ —Å–æ–±—ã—Ç–∏–µ
GET /events/search?q=...      # –ü–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π
GET /events/categories/all    # –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
POST /events                  # –°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ
PUT /events/:id              # –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ
DELETE /events/:id           # –£–¥–∞–ª–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ
```

## ü§ñ Telegram Bot

–ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è:

- –ü–æ–∏—Å–∫–∞ —Å–æ–±—ã—Ç–∏–π
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –¥–∞—Ç–∞–º
- –ü–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –æ —Å–æ–±—ã—Ç–∏—è—Ö
- –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –¥–∞–π–¥–∂–µ—Å—Ç–∞ –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π

## üîÑ –í–µ–±-–∫—Ä–∞—É–ª–µ—Ä

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç —Å–∞–π—Ç—ã —Å —Å–æ–±—ã—Ç–∏—è–º–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ API —á–µ—Ä–µ–∑ RabbitMQ.

- **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ**: –∫–∞–∂–¥—ã–µ 3 —á–∞—Å–∞ (0:00, 3:00, 6:00, 9:00, 12:00, 15:00, 18:00, 21:00)
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**: Playwright + Stealth —Ä–µ–∂–∏–º
- **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥**: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Redis –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**: `apps/web-crawler/crawl-configs/`

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
make crawler-logs

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
make crawler-health
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–ë–î, Redis, RabbitMQ)
docker-compose up -d db redis rabbitmq

# –ó–∞–ø—É—Å–∫ API –≤ dev —Ä–µ–∂–∏–º–µ
npm run dev --workspace=apps/api

# –ó–∞–ø—É—Å–∫ Bot –≤ dev —Ä–µ–∂–∏–º–µ
npm run dev --workspace=apps/bot

# –ó–∞–ø—É—Å–∫ Crawler –≤ dev —Ä–µ–∂–∏–º–µ
npm run dev --workspace=apps/web-crawler
```

### –°–±–æ—Ä–∫–∞

```bash
# –°–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
npm run build

# –°–±–æ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
npm run build --workspace=apps/api
```

### –õ–∏–Ω—Ç–∏–Ω–≥ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –õ–∏–Ω—Ç–∏–Ω–≥
npm run lint

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
npm run format

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
npm run format:check
```

## üö® –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

```bash
# API
curl http://localhost:3000/health

# PostgreSQL
docker exec concierge-postgres pg_isready

# Redis
docker exec concierge-redis redis-cli ping

# RabbitMQ
curl http://localhost:15672/api/health/checks/alarms
```

### –õ–æ–≥–∏

```bash
# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose logs -f

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
docker-compose logs -f api
docker-compose logs -f bot

# –° —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs --since 1h api
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker stats

# –î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
docker system df
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –í—Å–µ –ø–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –≤ –æ–±–ª–∞–∫–æ

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
docker-compose logs <service_name>
docker-compose restart <service_name>
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

```bash
docker-compose logs db
docker-compose restart db
```

### –û—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏

```bash
docker-compose build --no-cache
docker system prune -a
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

[–£–∫–∞–∂–∏—Ç–µ –≤–∞—à—É –ª–∏—Ü–µ–Ω–∑–∏—é]

## üë• –ê–≤—Ç–æ—Ä—ã

[–£–∫–∞–∂–∏—Ç–µ –∞–≤—Ç–æ—Ä–æ–≤]

## ü§ù –í–∫–ª–∞–¥

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è pull requests. –î–ª—è —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–Ω–∞—á–∞–ª–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ issue –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è.
